#!/usr/bin/env ruby
v2_path = File.expand_path('../app/javascript/v2', __dir__)

env = {
  'WEBPACKER_CONFIG' => File.join(v2_path, 'webpacker-v2.yml'),
  'RAILS_ENV' => 'development',
  'NODE_ENV' => 'development',
  'WEBPACK_DEV_SERVER' => 'true'
}

Dir.chdir(v2_path) do
  Kernel.exec(
    env,
    File.expand_path('./node14', __dir__),
    File.join(v2_path, 'node_modules/.bin/webpack'),
    'serve',
    '--config', File.join(v2_path, 'webpack-v2.js')
  )
end
